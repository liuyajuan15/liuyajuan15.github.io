---
title: git使用
date: 2017-01-05 12:00:33
updated: 2017-01-05 12:00:33
tags: [git]
categories: 其他
---
看完廖雪峰老师的git教程后，对git的使用有所了解，因此整理一下，作为参考 https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000
### 一、Git简介
#### 1. Git的诞生
#### 2. 集中式vs分布式
>集中式版本控制系统最大的毛病就是必须联网才能工作，如果在局域网内还好，带宽够大，速度够快，可如果在互联网上，遇到网速慢的话，可能提交一个10M的文件就需要5分钟，这还不得把人给憋死啊。
 那分布式版本控制系统与集中式版本控制系统有何不同呢？首先，分布式版本控制系统根本没有“中央服务器”，每个人的电脑上都是一个完整的版本库，这样，你工作的时候，就不需要联网了，因为版本库就在你自己的电脑上。既然每个人电脑上都有一个完整的版本库，那多个人如何协作呢？比方说你在自己电脑上改了文件A，你的同事也在他的电脑上改了文件A，这时，你们俩之间只需把各自的修改推送给对方，就可以互相看到对方的修改了。
 和集中式版本控制系统相比，分布式版本控制系统的安全性要高很多，因为每个人电脑里都有完整的版本库，某一个人的电脑坏掉了不要紧，随便从其他人那里复制一个就可以了。而集中式版本控制系统的中央服务器要是出了问题，所有人都没法干活了。
 在实际使用分布式版本控制系统的时候，其实很少在两人之间的电脑上推送版本库的修改，因为可能你们俩不在一个局域网内，两台电脑互相访问不了，也可能今天你的同事病了，他的电脑压根没有开机。因此，分布式版本控制系统通常也有一台充当“中央服务器”的电脑，但这个服务器的作用仅仅是用来方便“交换”大家的修改，没有它大家也一样干活，只是交换修改不方便而已。

### 二、安装Git
```php
以下是Mac下的安装
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> brew install git
```
### 三、创建版本库
>版本库又名仓库，英文名repository，你可以简单理解成一个目录，这个目录里面的所有文件都可以被Git管理起来，每个文件的修改、删除，Git都能跟踪，以便任何时刻都可以追踪历史，或者在将来某个时刻可以“还原”。

```php
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> mkdir learnGit
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> cd learnGit
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> pwd
/Users/liuyajuan/Sites/learnGit
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> git init  //利用git init 把这个目录变成Git可以管理的仓库，会发现当前目录下多了一个.git的目录
//把文件添加到版本库的方法：
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> git add test.txt //git add 添加文件
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> git commit -m 'wrote a test file' // -m '' 是输入提交的说明，方便能从历史记忆里很快的找到需要的内容
```
>初始化一个Git仓库，使用 **git init** 命令。
 添加文件到Git仓库，分两步：
 第一步，使用命令 **git add <file>** ，注意，可反复多次使用，添加多个文件；
 第二步，使用命令 **git commit**，完成。
 
### 四、时光机穿梭
#### 1. 版本回退
>1. **git status** 查看哪些文件被修改，可以随时掌握工作区的状态
 2. **git diff** 查看修改的内容
 3. HEAD指向的版本就是当前版本，因此，Git允许我们在版本的历史之间穿梭，使用命令 **git reset --hard commit_id**。
 4. 穿梭前，用**git log**可以查看提交历史，以便确定要回退到哪个版本。
 5. 要重返未来，用**git reflog**查看命令历史，以便确定要回到未来的哪个版本。
 
#### 2. 工作区和暂存区
> 以上的learnGit就是我的工作区，工作区有一个隐藏的目录.git,这个就是Git的版本库
版本库中最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的第一个分支master，以及指向master的一个指针叫HEAD。
前面讲了我们把文件往Git版本库里添加的时候，是分两步执行的：
第一步是用git add把文件添加进去，实际上就是把文件修改添加到暂存区；
第二步是用git commit提交更改，实际上就是把暂存区的所有内容提交到当前分支。
因为我们创建Git版本库时，Git自动为我们创建了唯一一个master分支，所以，现在，git commit就是往master分支上提交更改。
你可以简单理解为，需要提交的文件修改通通放到暂存区，然后，一次性提交暂存区的所有修改。

#### 3. 管理修改
>Git管理的是修改，当你用git add命令后，在工作区的第一次修改被放入暂存区，准备提交，但是，在工作区的第二次修改并没有放入暂存区，所以，git commit只负责把暂存区的修改提交了，也就是第一次的修改被提交了，第二次的修改不会被提交。

#### 4.撤销修改
>场景1：当你改乱了工作区某个文件的内容，想直接丢弃工作区的修改时，用命令 **git checkout -- file**。
 场景2：当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令**git reset HEAD file**，就回到了场景1，第二步按场景1操作。
 场景3：已经提交了不合适的修改到版本库时，想要撤销本次提交，参考版本回退一节，不过前提是没有推送到远程库。
 
#### 5.删除文件
>命令git rm用于删除一个文件。如果一个文件已经被提交到版本库，那么你永远不用担心误删，但是要小心，你只能恢复文件到最新版本，你会丢失最近一次提交后你修改的内容。
 
### 五、远程仓库
#### 1. 添加远程库
>要关联一个远程库，使用命令git remote add origin git@server-name:path/repo-name.git；
 关联后，使用命令git push -u origin master第一次推送master分支的所有内容；
 此后，每次本地提交后，只要有必要，就可以使用命令git push origin master推送最新修改；
 分布式版本系统的最大好处之一是在本地工作完全不需要考虑远程库的存在，也就是有没有联网都可以正常工作，而SVN在没有联网的时候是拒绝干活的！当有网络的时候，再把本地提交推送一下就完成了同步，真是太方便了！
 
#### 2. 从远程库克隆
>要克隆一个仓库，首先必须知道仓库的地址，然后使用git clone命令克隆。
Git支持多种协议，包括https，但通过ssh支持的原生git协议速度最快。

### 六、分支管理
#### 1. 创建与合并分支
>1. 查看分支：git branch
2. 创建分支：git branch <name>
3. 切换分支：git checkout <name>
4. 创建+切换分支：git checkout -b <name>
5. 合并某分支到当前分支：git merge <name>
6. 删除分支：git branch -d <name>

#### 2. 解决冲突
>当Git无法自动合并分支时，就必须首先解决冲突。解决冲突后，再提交，合并完成。
 用git log --graph命令可以看到分支合并图。
 
#### 3. 分支管理策略
>Git分支十分强大，在团队开发中应该充分应用。
 合并分支时，加上--no-ff参数就可以用普通模式合并，合并后的历史有分支，能看出来曾经做过合并，而fast forward合并就看不出来曾经做过合并
 
#### 4. Bug分支
>修复bug时，我们会通过创建新的bug分支进行修复，然后合并，最后删除；
当手头工作没有完成时，先把工作现场git stash一下，然后去修复bug，修复后，再git stash pop，回到工作现场。

#### 5. Feature分支
>开发一个新feature，最好新建一个分支；
 如果要丢弃一个没有被合并过的分支，可以通过git branch -D <name>强行删除。
 
#### 6.多人协作
>1. 查看远程库信息，使用git remote -v；
2. 本地新建的分支如果不推送到远程，对其他人就是不可见的；
3. 从本地推送分支，使用git push origin branch-name，如果推送失败，先用git pull抓取远程的新提交；
4. 在本地创建和远程分支对应的分支，使用git checkout -b branch-name origin/branch-name，本地和远程分支的名称最好一致；
5. 建立本地分支和远程分支的关联，使用git branch --set-upstream branch-name origin/branch-name；
6. 从远程抓取分支，使用git pull，如果有冲突，要先处理冲突。

### 七、标签管理
#### 1. 创建标签 
>1. 命令**git tag <name>** 用于新建一个标签，默认为HEAD，也可以指定一个commit id；
2. **git tag -a <tagname> -m "blablabla..."** 可以指定标签信息；
3. **git tag -s <tagname> -m "blablabla..."**可以用PGP签名标签；
4. 命令**git tag**可以查看所有标签。
 
#### 2. 操作标签
>1. 命令**git push origin <tagname>** 可以推送一个本地标签；
2. 命令**git push origin --tags** 可以推送全部未推送过的本地标签；
3. 命令**git tag -d <tagname>** 可以删除一个本地标签；
4. 命令**git push origin :refs/tags/<tagname>** 可以删除一个远程标签
 
### 八、自定义git
>忽略某些文件时，需要编写.gitignore;.gitignore文件本身要放到版本库里，并且可以对.gitignore做版本管理！

 └─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> git config --global alias.co checkout
 
 └─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> git config --global alias.ci commit
 
 └─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> git config --global alias.br branch
 
 └─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> git config --global alias.st status
 
 └─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> git config --global alias.last 'log -1'