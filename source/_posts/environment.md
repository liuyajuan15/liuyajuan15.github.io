---
title: Linux 环境变量和查找文件
date: 2017-10-19 10:07:17
categories: Linux
tags: Linux

---
>内容参考于<a href="https://www.shiyanlou.com">实验楼</a>

### 一、变量
要明白环境变量，首先需要明白变量是什么，准确的说应该是Shell变量。变量的作用域即变量的有效范围，在该范围内只有有一个同名变量。一旦离开则该变量无效，如同不存在一般。

1.创建变量

```
#使用 declare 命令创建一个变量名为 tmp 的变量：
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> declare tmp
#也可以即用即创建，使用 = 赋值
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> tmp=yajuanl
```

2.读取变量

```
#读取变量的值，使用echo命令和$符号
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> echo $tmp
yajuanl
```

3.清除变量

```
#清除变量使用unset
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> unset $tmp
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> echo $tmp

```
4.设置只读变量

```
#使用了readonly命令的话，变量就不可以被修改或清除了
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> export TEST='test...'
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> readonly TEST
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> unset TEST
zsh: read-only variable: TEST
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> echo $TEST
test...
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> TEST='new'
zsh: read-only variable: TEST
```

**注意：并不是任何形式的变量名都是可用的，变量名只能是英文字母、数字或者下划线，且不能以数字作为开头。**

### 二、环境变量
环境变量的作用域比自定义变量的要大，如 Shell 的环境变量作用于自身和它的子进程。在所有的 UNIX 和类 UNIX 系统中，每个进程都有其各自的环境变量设置，且默认情况下，当一个进程被创建时，除了创建过程中明确指定的话，它将继承其父进程的绝大部分环境设置。Shell 程序也作为一个进程运行在操作系统之上，而我们在 Shell 中运行的大部分命令都将以 Shell 的子进程的方式运行。

通常我们会涉及到的变量类型有三种：

* 当前Shell进程私有用户自定义变量，比如上面创建的tmp变量，只在当前Shell中有效。
* Shell本身内建的变量。
* 从自定义变量导出的环境变量。

环境变量相关命令：

* set 显示当前Shell所有变量，包括其内建环境变量，用户自定义变量及导出的环境变量。
* env 显示与当前用户相关的环境变量，还可以让命令在指定环境中运行。
* export 显示从Shell中导出成环境变量的变量，也能通过它将自定义变量导出为环境变量。

```

└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >>aaa=bbb  --shell变量设定     
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> echo $aaa      
bbb     
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> env| grep aaa --设置完当前用户变量并没有     
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >>set| grep aaa  --shell变量有     
aaa=bbb     
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> export| grep aaa --这个指的export也没导出，导出变量也没有     
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> export aaa   --那么用export 导出一下     
└─>[娟姐 😜 👉  ]🤑  好好挣钱 🤑️ >> env| grep aaa  --发现用户变量内存在了     
aaa=bbb  
```

**总结：shell变量（set），用户变量（env），shell变量包含用户变量，export是一种命令工具，是显示那些通过export命令把shell变量中包含的用户变量导入给用户变量的那些变量**

### 三、变量永久生效
问题来了，当你关机之后，或者关闭当前的shell之后，环境变量就没了啊，怎么才能让环境变量永久生效呢?
按变量的生存周期来划分，Linux 变量可分为两类：

* 永久的：需要修改配置文件，变量永久生效； **每个用户目录下的一个隐藏文件.profile,这个 .profile 只对当前用户永久生效。而写在 /etc/profile 里面的是对所有用户永久生效，所以如果想要添加一个永久生效的环境变量，只需要打开 /etc/profile，在最后加上你想添加的环境变量就好啦。**
* 临时的：使用export命令行声明即可，变量在关闭shell是失效。

最根本的设置、更改变量的配置文件 ~/.bash_profile   ~/.bashrc   ~/.bash_logout

~/.bash_profile  用户登录时被读取，其中包含的命令被执行

~/.bashrc  启动新的shell时被读取，并执行

~/.bash_logout  shell 登录退出时被读取

此外，shell（这里指ｂａｓｈ）的初始化过程是这样的：

1. bash 检查文件/etc/profile 是否存在
2. 如果存在，bash 就读取该文件，否则，跳过
3. bash 检查主目录下的文件.bash_profile 是否存在。
4. 如果存在，bash 就读取該文件，否则，跳过
5. bash 检查主目录下的.bash_login 是否存在。
6. 如果存在，bash 就读取该文件，否则，跳过
7. bash 检查主目录下的文件.profile 是否存在
8. 如果存在， bash 就读取该文件，否则，跳过。
这些步骤都执行完后，就出现提示符了， ksh 默认提示符是 $.


